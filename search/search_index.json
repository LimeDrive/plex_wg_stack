{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Description","text":"<p>plew_wg_stack is a collection of two Docker Compose files and related configurations. The first one is designed to run a WireGuard container from LinuxServer.io (lsio) as a server, intended for deployment on an affordable VPS. The second Compose file runs an lsio Plex container with default IP routing modified to pass through a WireGuard container, which operates as a client on the same machine.</p> <p>A set of scripts is also included to assist in configuring the WireGuard containers.</p> <p>Here are a few key points to consider with this stack:</p> <ul> <li> <p>The primary objective is to either run Plex behind a VPN or access Plex from within a VPN. This approach can be applied to other lsio containers as well.</p> </li> <li> <p>This stack does not use `network_mode: \"service:wireguard\". This choice is made to avoid conflicts in the use of container networks, enabling the concurrent operation of multiple stacks within the same VPN/container. This setup allows you to run multiple services like Plex, WireGuard, Transmission, and others without port conflicts. Your web user interface and any existing reverse proxy configurations will continue to function when connected to the VPN.</p> </li> <li> <p>The bundle of scripts provided is intended to facilitate the setup of the WireGuard container. They are not mandatory, and you can use your custom configurations if desired.</p> </li> <li> <p>This stack supports only lsio containers or containers running on s6-overlay.</p> </li> <li> <p>On the server side, port forwarding is handled within the container, and Docker manages the port forwarding from the host to the container.</p> </li> </ul>"},{"location":"gluetun/gluetun_plex_install_ssdv2/","title":"Installations de Plex sous VPN avec Gluetun","text":"<p>Ce guide explique comment installer Plex sous VPN avec Gluetun. En utilisant un VPN gratuit : ProtonVPN.</p> <p>Info</p> <p>La configuration dans se guide met le container plex dans le meme reseau que gluetun. Cela permet d'est sous VPN mais d'\u00e9tre accessible depuis le reseau local. Donc les stream ne passent pas par le VPN.</p> <p>Il est destin\u00e9 aux utilisateurs de SSDV2 et n'est pas support\u00e9 officiellement par le projet.</p> <pre><code>flowchart LR\n    A[USER 1\\n STREAM] --&gt;|HTTPS by Cloudflare| B(TRAEFIK)\n    A2[USER 2\\n STREAM] --&gt;|HTTPS by Cloudflare| B(TRAEFIK)\n    A3[USER 3\\n STREAM] --&gt;|HTTPS by Cloudflare| B(TRAEFIK)\n    subgraph local [LOCAL DOCKER]\n    B(TRAEFIK)\n    B --&gt;|32400 on local| ide1\n    subgraph ide1 [VPN GLUETUN NETWORK]\n    C{PLEX \\nCONTAINER} ---|network_mode| D(GLUETUN \\nCONTAINER)\n    end\n    end\n    subgraph net [NET OUTSIDE WORLD]\n    E[API\\n plex.tv]\n    F[IP\\n CHECK]\n    end\n    ide1 --&gt;|api| net\n    ide1 --&gt;|posters| net\n    ide1 --&gt;|ipcheck| net</code></pre> <p>Note</p> <p>Plex n'utilise que tr\u00e9s peu de bande passante. Donc vous pouvez utiliser un VPN gratuit avec une bande passante limit\u00e9 sans probl\u00e9me.</p> Exemple <pre><code>    ens160  /  daily\n    day        rx      |     tx      |    total    |   avg. rate\n------------------------+-------------+-------------+---------------\n2023-09-16    36.50 MiB |   45.33 MiB |   81.83 MiB |    7.95 kbit/s\n2023-09-17    92.84 MiB |   85.11 MiB |  177.95 MiB |   17.28 kbit/s\n2023-09-18   127.20 MiB |  135.48 MiB |  262.69 MiB |   25.50 kbit/s\n2023-09-19   222.37 MiB |  284.93 MiB |  507.30 MiB |   49.25 kbit/s\n2023-09-20   425.00 MiB |  345.23 MiB |  770.23 MiB |   74.78 kbit/s\n2023-09-21   229.13 MiB |  219.93 MiB |  449.06 MiB |   43.60 kbit/s\n2023-09-22   220.43 MiB |  212.48 MiB |  432.91 MiB |   42.03 kbit/s\n2023-09-23   175.82 MiB |  169.01 MiB |  344.83 MiB |   33.48 kbit/s\n2023-09-24   124.10 MiB |  110.24 MiB |  234.33 MiB |   22.75 kbit/s\n2023-09-25   117.24 MiB |  111.70 MiB |  228.94 MiB |   29.23 kbit/s\n------------------------+-------------+-------------+---------------\nestimated    154.17 MiB |  146.83 MiB |  301.00 MiB |\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#cree-un-compte-protonvpn-et-recuperer-les-identifiants-dopenvpn-gratuit","title":"Cree un compte ProtonVPN et recuperer les identifiants d'openvpn gratuit","text":"<ol> <li>Creer un compte ProtonVPN ici</li> <li>Recuperer les identifiants d'openvpn gratuit ici</li> </ol>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#procedure-dinstallation-pour-les-utilisateurs-du-script-ssdv2","title":"Proc\u00e9dure d'installation pour les utilisateurs du script SSDV2","text":"<p>Attention</p> <p>Cette proc\u00e9dure est destin\u00e9 aux utilisateurs du script SSDV2. Si vous n'utilisez pas le script SSDV2, vous devez adapter les chemins de cette proc\u00e9dure \u00e0 votre installation.</p> <p>Danger</p> <p>Veillez \u00e0 bien remplacer les variables par les votres. Chaque installation est unique donc bien verifier les chemins et les ports. Surtout stopper votre ancien container plex</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#prerequis","title":"Pr\u00e9requis","text":""},{"location":"gluetun/gluetun_plex_install_ssdv2/#avoir-un-nom-de-domaine-configure-pour-plex-sur-votre-serveur","title":"Avoir un nom de domaine configur\u00e9 pour plex sur votre serveur.","text":"<p>Les utlisateurs de cloudflare deveront imp\u00e9rativement suivre la partie 8 pour bypass le cache. Nous allons faire passer le traffic des stream par le proxy cloudflare, donc si le cache est activ\u00e9 vous risquez d'avoir des erreurs de lecture et un ban de leur service.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#installer-docker-et-docker-compose","title":"Installer docker et docker-compose","text":"<p>Docker et install\u00e9 par defaut sur SSDV2, mais ce n'est pas le cas de docker compose.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#veriier-si-docker-compose-est-installe","title":"V\u00e9riier si docker-compose est install\u00e9","text":"<pre><code>docker compose version\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#installer-docker-compose-si-nessessaire","title":"Installer docker-compose si nessessaire","text":"<pre><code>sudo apt install docker-compose-plugin\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#verifiez-que-votre-ancinen-container-plex-est-bien-stoppe-et-supprimer","title":"Verifiez que votre ancinen container plex est bien stopp\u00e9 et supprimer.","text":"<p>Note</p> <p>Inutil si vous n'aviez pas d'ancien container plex. Donc en cas de nouvelle installation.</p> <pre><code>docker inspect -f '{{.State.Status}}' plex\n</code></pre> <p>Si vous voyez <code>running</code> ou <code>restarting</code> vous devez stopper votre ancien container plex.</p> <pre><code>docker stop plex &amp;&amp; docker rm plex\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#installation","title":"Installation","text":""},{"location":"gluetun/gluetun_plex_install_ssdv2/#1-creer-un-dossier-pour-la-stack-plex","title":"1. Creer un dossier pour la stack Plex","text":"<pre><code>mkdir -p /home/$USER/plex_vpn\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#2-se-placer-dans-le-dossier","title":"2. Se placer dans le dossier","text":"<pre><code>cd /home/$USER/plex_vpn\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#3-telecharger-le-fichier-docker-composeyml-depuis-le-depot","title":"3. Telecharger le fichier docker-compose.yml depuis le depot","text":"<pre><code>curl -o docker-compose.yml https://raw.githubusercontent.com/LimeDrive/plex_wg_stack/master/deploy/gluetun/ssdv2-gluetun-compose.yml\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#4-cree-et-editer-le-fichier-env","title":"4. Cr\u00e9e et editer le fichier .env","text":""},{"location":"gluetun/gluetun_plex_install_ssdv2/#41-cree-le-fichier-env-dans-le-dossier-plex_vpn-ledite-avec-nano","title":"4.1. Cr\u00e9e le fichier .env dans le dossier plex_vpn l'\u00e9dit\u00e9 avec nano","text":"<pre><code>touch .env &amp;&amp; nano .env\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#42-remplacer-les-variables-par-les-votres","title":"4.2. Remplacer les variables par les votres.","text":"<p>Note</p> <p>Vous pouvez copier coller le bloc de code ci-dessous et remplacer les variables par les votres.</p> <p>Attention</p> <p>Les $USER sont a remplacer par votre nom d'utilisateur sur votre serveur.</p> <pre><code>XID=1000 # (1)\nGLUETUN_TAG='latest' # (2)\nPLEX_TAG='latest' # (3)\nTZ='Europe/Paris' # (4)\nDOMAIN='plex.example.com' # (5)\nPATH_PLEX_CONFIG='/home/$USER/check/path/plex/config/on/host' # (6)\nPATH_HOME='/home/$USER' # (7)\nOPENVPN_USER='protonvpn_username' # (8)\nOPENVPN_PASSWORD='protonvpn_password' # (9)\n</code></pre> <ol> <li>ID de votre utilisateur sur votre serveur</li> <li>Image tag de gluetun.</li> <li>Image tag de plex.</li> <li>Fuseau horaire de votre serveur.</li> <li>Nom de domaine que vous avez configur\u00e9 pour plex sur votre serveur.</li> <li>Chemin de votre dossier de configuration plex sur votre serveur.</li> <li>Chemin absolu de votre dossier home sur votre serveur.</li> <li>Votre nom d'utilisateur ProtonVPN.</li> <li>Votre mot de passe ProtonVPN.</li> </ol>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#421-explication-des-variables","title":"4.2.1 Explication des variables.","text":"<ul> <li> <p><code>XID</code> : L'ID de votre utilisateur sur votre serveur</p> <p><code>id -u $USER</code></p> </li> <li> <p><code>GLUETUN_TAG</code> : La version de gluetun que vous voulez utiliser. Voir les versions</p> <p>default : Vous pouvez utilis\u00e9 <code>latest</code> pour la derniere version.</p> </li> <li> <p><code>PLEX_TAG</code> : La version de plex que vous voulez utiliser. Voir les versions</p> <p>default : Vous pouvez utilis\u00e9 <code>latest</code> pour la derniere version.</p> </li> <li> <p><code>TZ</code> : Le fuseau horaire de votre serveur. Voir les fuseaux horaires</p> <p>default : <code>Europe/Paris</code></p> </li> <li> <p><code>DOMAIN</code> : Le nom de domaine que vous avez configur\u00e9 pour plex sur votre serveur.</p> <p>REQUIRED : <code>plex.example.com</code></p> </li> <li> <p><code>PATH_PLEX_CONFIG</code> : Le chemin de votre dossier de configuration plex sur votre serveur.</p> <p>REQUIRED : <code>/home/$USER/seedbox/docker/$USER/plex/config</code></p> <p>Note</p> <p>Pour les utilisateurs du scripte SSDV2 :</p> <p>nouvelle install : <code>/home/$USER/seedbox/docker/$USER/plex/config</code></p> <p>old install : <code>/opt/seedbox/docker/$USER/plex/config</code></p> </li> <li> <p><code>PATH_HOME</code> : Le chemin absolu de votre dossier home sur votre serveur.</p> <p>REQUIRED : <code>/home/$USER</code></p> </li> <li> <p><code>OPENVPN_USER</code> et <code>OPENVPN_PASSWORD</code> : Votre nom d'utilisateur et pass ProtonVPN</p> <p>REQUIRED : <code>1_username</code> et <code>2_password</code></p> <p></p> </li> </ul>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#43-sauvegarder-et-quitter","title":"4.3. Sauvegarder et quitter","text":"<p>Ctrl+X pour quitter et Y pour sauvegarder</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#5-lancer-la-stack","title":"5. Lancer la stack","text":"<pre><code>docker compose up -d\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#6-verifier-que-tout-est-ok","title":"6. Verifier que tout est ok.","text":"<pre><code>docker exec plex curl -sSL https://ipv4.icanhazip.com\n</code></pre> <p>Note</p> <p>Vous devriez voir l'ip de votre VPN et non celle de votre serveur.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#7-reglage-de-plex","title":"7. R\u00e9glage de Plex.","text":"<p>Attention</p> <p>Si vous faite une nouvelle installation de plex vous devez suivre la partie 10 pour claim le server. Avant de faire les r\u00e9glages.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#71-dans-la-section-network-de-plex-cliquez-sur-show-advanced-et-remplissez-les-champs-comme-sur-limage-ci-dessous","title":"7.1. Dans la section <code>Network</code> de Plex, cliquez sur <code>Show Advanced</code> et remplissez les champs comme sur l'image ci-dessous.","text":"<ol> <li> <p>Desactivez le relais si vous le souhaiter.</p> </li> <li> <p>Dans URL personnalis\u00e9e, entrez l'adresse de votre serveur Plex. Entrez l'adresse compl\u00e8te, y compris le protocole (https) et le port (443).</p> <p><code>https://plex.example.com:443</code></p> <p>Note</p> <p>Si vous utilisez une connection http sur de vieux appareille ( certaine TV ), entrez l'adresse IP compl\u00e8te en http et le port (80) - optionel.</p> <p><code>https://plex.example.com:443,http://plex.example.com:80</code></p> </li> </ol>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#72-dans-la-section-remote-access-de-plex-cliquez-sur-disable-remote-access","title":"7.2. Dans la section <code>Remote Access</code> de Plex, cliquez sur <code>Disable Remote Access</code>.","text":"<p>Sa nous assure que Plex ne va pas essayer de se connecter directement \u00e0 votre serveur. Vous devez voir afficher <code>Not available outside your network</code> comme sur l'image ci-dessous.</p> <p></p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#8-verifier-les-reglages-de-cloudflare","title":"8. Verifier les r\u00e9glages de Cloudflare.","text":"<p>Avec cloudflare qui proxy votre domaine, vous devez vous assurer que sur le sous-domaine <code>plex.example.com</code> une regle de cache est bien appliqu\u00e9.</p> <p>Sur votre dashboard cloudflare ici :</p> <p></p> <p>Dans les r\u00e9gles de cache, vous devez avoir une regle pour le sous-domaine <code>plex.example.com</code> visible :</p> <p></p> <p>Si vous ne voyez pas de regle, vous devez en cr\u00e9er une.</p> <p></p> <p></p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#9-optionelle-activation-de-l-igpu-pour-les-processeurs-intel","title":"9. Optionelle : Activation de l' iGPU pour les processeurs Intel.","text":"<p>Attention</p> <p>Cette partie est optionelle et ne concerne que les utilisateurs de processeurs Intel avec un iGPU.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#91-suivre-la-documentation-hetzner-sur-le-systeme-dexploitation-de-votre-serveur","title":"9.1. Suivre la documentation Hetzner sur le syst\u00e8me d'exploitation de votre serveur.","text":"<p>Documentation Hetzner : Enabling the iGPU on Intel Processors</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#92-editer-le-fichier-docker-composeyml","title":"9.2. Editer le fichier <code>docker-compose.yml</code>","text":"<p>Agouter les lignes suivantes dans le service <code>plex</code> :</p> <pre><code>...\nplex:\n    image: plexinc/pms-docker:${PLEX_TAG:-latest}\n    ...\n    devices:\n    - /dev/dri:/dev/dri\n    volumes:\n    ...\n    - /dev/dri:/dev/dri\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#93-redemarrer-le-container-plex","title":"9.3. Redemarrer le container plex","text":"<pre><code>docker compose up -d plex\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#10-optionelle-claim-du-server-pour-les-nouvelle-installation","title":"10. Optionelle : Claim du server pour les nouvelle installation.","text":"<p>Si vous n'aviez pas d'intallation plex avant, vous devez claim le server pour pouvoir l'utiliser.</p> <p>Success</p> <p>La procedure est a faire en moin de 4 minutes sinon le claim token expire.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#101-preparer-la-variable-claim-token","title":"10.1. Preparer la variable claim token","text":"<ul> <li>Editer le fichier <code>docker-compose.yml</code> :</li> </ul> <pre><code>nano docker-compose.yml\n</code></pre> <ul> <li>Ajouter la variable <code>PLEX_CLAIM</code> dans le service <code>plex</code> :</li> </ul> <pre><code>...\nplex:\n    image: plexinc/pms-docker:${PLEX_TAG:-latest}\n    ...\n    environment:\n        PLEX_CLAIM: 'claim-xxxxxxxxxxxxxxxxxxxx' # (1)\n        ...\n</code></pre> <ol> <li>Remplacer <code>claim-xxxxxxxxxxxxxxxxxxxx</code> par votre claim token.     Voir la partie 10.2 pour recuperer le claim token.</li> </ol>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#102-recuperer-le-claim-token","title":"10.2. Recuperer le claim token","text":"<p>Se rendre sur le site de plex ici, se connecter et recuperer le claim token.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#103-enregistrer-et-quitter","title":"10.3. Enregistrer et quitter","text":"<p>Ctrl+X pour quitter et Y pour sauvegarder</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#104-reconstruire-et-re-up-le-container-plex","title":"10.4. Reconstruire et re-up le container plex","text":"<pre><code>docker compose rm -s plex\n</code></pre> <pre><code>docker compose up -d plex\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#maintenance-et-mise-a-jour","title":"Maintenance et mise a jour","text":"<p>Tip</p> <p>Pour la maintenance et la mise a jour de la stack, mieux vaut utiliser les commandes docker-compose plutot que les commandes docker de ssd.</p>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#1-arreter-la-stack","title":"1. Arreter la stack","text":"plexgluetunplex et gluetun <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose stop plex\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose stop gluetun\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose stop\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#2-mettre-a-jour-les-images","title":"2. Mettre a jour les images","text":"plexgluetunplex et gluetun <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose pull plex\ndocker compose up -d plex\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose pull gluetun\ndocker compose up -d gluetun\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose pull\ndocker compose up -d\n</code></pre>"},{"location":"gluetun/gluetun_plex_install_ssdv2/#3-redemarrer-la-stack","title":"3. Redemarrer la stack","text":"plexgluetunplex et gluetun <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose restart plex\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose restart gluetun\n</code></pre> <pre><code>cd /home/$USER/plex_vpn &amp;&amp; docker compose restart\n</code></pre> <p>enjoy !</p>"},{"location":"wg-stack/install_server_vps/","title":"Guide d'installation d'une VPS pour WireGuard","text":""},{"location":"wg-stack/install_server_vps/#introduction","title":"Introduction","text":"<p>Ce guide vous aidera \u00e0 installer un serveur VPS pour WireGuard sous docker.  Plusieurs fournisseurs de VPS peuvent offrire des services gratuits ou tr\u00e9s peu on\u00e9reux.  Nous allons utiliser un VPS a 1,20\u20ac/mois chez IONOS pour ce guide.</p> <p>Conseil</p> <p>Pour le choix du VPS, il est important de choisir un fournisseur qui offre une adresse IPv4 publique fixe et une bande passante illimit\u00e9e.</p>"},{"location":"wg-stack/install_server_vps/#configuration-du-vps","title":"Configuration du VPS","text":""},{"location":"wg-stack/install_server_vps/#se-connecter-au-vps","title":"Se connecter au VPS","text":"<p>Pour se connecter au VPS, nous allons utiliser le protocole SSH. R\u00e9cup\u00e9rer l'adresse IP du VPS dans l'interface de votre fournisseur. Et le mot de passe dans le mail de confirmation ou sur l'interface selon votre fournisseur.</p> <ul> <li>Se connecter en root</li> </ul> <pre><code>ssh root@&lt;ip&gt;\n</code></pre> <p>Apr\u00e9s avoir entr\u00e9 le mot de passe, vous devriez voir un message de bienvenue.</p>"},{"location":"wg-stack/install_server_vps/#mettre-a-jour-le-systeme","title":"Mettre \u00e0 jour le syst\u00e8me","text":"<pre><code>apt update &amp;&amp; apt upgrade -y\n</code></pre> <p>Note</p> <p>Si des message apparaissent, on valide par OK.</p>"},{"location":"wg-stack/install_server_vps/#redemarrer-le-vps","title":"Red\u00e9marrer le VPS","text":"<p>Red\u00e9marage du VPS pour appliquer les mises \u00e0 jour. Apr\u00e9s le red\u00e9marrage, il faudra se reconnecter au VPS.</p> <pre><code>reboot\n</code></pre>"},{"location":"wg-stack/install_server_vps/#changment-du-hostname","title":"Changment du hostname","text":"<ul> <li>Modifer hostname</li> </ul> <pre><code>hostnamectl set-hostname &lt;hostname&gt;\n</code></pre> <ul> <li>Modifiez le fichier <code>hosts</code> avec le nouveau hostname</li> </ul> <pre><code>nano /etc/hosts\n</code></pre> <pre><code>127.0.1.1 &lt;hostame&gt;\n</code></pre>"},{"location":"wg-stack/install_server_vps/#mettre-en-place-une-cle-ssh","title":"Mettre en place une cl\u00e9 SSH","text":"<ul> <li>G\u00e9n\u00e9rer une cl\u00e9 SSH sur votre machine locale</li> </ul> <pre><code>ssh-keygen -t ed25519 -C \"wireguard\"\n</code></pre> <ul> <li>Copier la cl\u00e9 publique sur le VPS</li> </ul> <pre><code>ssh-copy-id root@&lt;ip&gt;\n</code></pre> <ul> <li>Se connecter au VPS avec la cl\u00e9 SSH</li> </ul> <pre><code>ssh root@&lt;ip&gt;\n</code></pre>"},{"location":"wg-stack/install_server_vps/#installation-de-zsh-et-oh-my-zsh","title":"Installation de zsh et oh-my-zsh","text":"<ul> <li>Installer zsh</li> </ul> <pre><code>apt install zsh -y\n</code></pre> <ul> <li>Installer oh-my-zsh</li> </ul> <pre><code>sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n</code></pre> <ul> <li>Adapter le fichier <code>.zshrc</code> a votre besoin</li> </ul> <pre><code>nano ~/.zshrc\n</code></pre>"},{"location":"wg-stack/install_server_vps/#creer-un-utilisateur","title":"Cr\u00e9er un utilisateur","text":"<ul> <li>Cr\u00e9er un utilisateur</li> </ul> <pre><code>adduser &lt;user&gt;\n</code></pre> <ul> <li>Ajouter l'utilisateur au groupe sudo</li> </ul> <pre><code>usermod -aG sudo &lt;user&gt;\n</code></pre> <ul> <li>Mettre en place une cl\u00e9 SSH pour l'utilisateur</li> </ul> <p>Sur la machine locale :</p> <pre><code>ssh-copy-id &lt;user&gt;@&lt;ip&gt;\n</code></pre>"},{"location":"wg-stack/install_server_vps/#configuration-des-ports-sur-le-panel-ionos","title":"Configuration des ports sur le Panel IONOS","text":"<p>Nous allons ouvrir les ports suivants sur le panel IONOS :</p> <ul> <li>51820/udp : WireGuard</li> <li>443/tcp : HTTPS</li> <li>80/tcp : HTTP</li> <li>/tcp : Un port de votre choix pour SSH"},{"location":"wg-stack/install_server_vps/#activer-le-firewall-sur-la-vps-et-ouvrir-les-ports","title":"Activer le firewall sur la VPS et ouvrir les ports","text":"<ul> <li>Allow les port ci-dessus avec ufw :</li> </ul> <pre><code>ufw allow 51820/udp\nufw allow 443/tcp\nufw allow 80/tcp\nufw allow &lt;port-ssh&gt;/tcp\n</code></pre> <ul> <li>Activer le firewall</li> </ul> <pre><code>ufw enable\n</code></pre>"},{"location":"wg-stack/install_server_vps/#changement-de-la-configuration-ssh","title":"Changement de la configuration SSH","text":"<ul> <li>Supprimer le cloud-init de sshd</li> </ul> <pre><code>rm -rf /etc/ssh/sshd_config.d/50-cloud-init.conf\n</code></pre> <ul> <li>Modifier le fichier de configuration SSH</li> </ul> <pre><code>nano /etc/ssh/sshd_config\n</code></pre> <ul> <li>Modifier les lignes suivantes :</li> </ul> <pre><code>Port &lt;port-ssh&gt;\nPermitRootLogin prohibit-password\nPasswordAuthentication no\nPermitEmptyPasswords no\n</code></pre> <ul> <li>Red\u00e9marrer le service SSH</li> </ul> <pre><code>systemctl restart sshd\n</code></pre>"},{"location":"wg-stack/install_server_vps/#installation-de-tailscale","title":"Installation de tailscale","text":"<p>Suivre la documentation officielle pour l'installation de tailscale : https://tailscale.com/kb/1085/install-debian/</p>"},{"location":"wg-stack/install_server_vps/#installation-de-docker","title":"Installation de docker","text":"<p>Se connecter en user avec la nouvelle configuration SSH :</p> <pre><code>ssh -p &lt;port-ssh&gt; -i ~/.ssh/id_ed25519 &lt;user&gt;@&lt;ip&gt;\n</code></pre> <ul> <li>Installer docker</li> </ul> <pre><code>curl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n</code></pre> <ul> <li>Ajouter l'utilisateur au groupe docker</li> </ul> <pre><code>sudo usermod -aG docker $USER\n</code></pre>"},{"location":"wg-stack/install_server_vps/#installation-de-crowdsec","title":"Installation de crowdsec","text":"<p>Se referer \u00e0 la documentation officielle pour l'installation de crowdsec : https://doc.crowdsec.net/docs/getting_started/installation/</p>"}]}